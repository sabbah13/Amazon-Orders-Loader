<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Amazon Order Loader Bookmarklet</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
            line-height: 1.6;
            color: #24292e;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        h1 {
            border-bottom: 1px solid #eaecef;
            padding-bottom: 0.3em;
        }

        h2 {
            margin-top: 24px;
            margin-bottom: 16px;
            font-weight: 600;
            line-height: 1.25;
        }

        .bookmarklet {
            display: inline-block;
            padding: 10px 16px;
            background: #4caf50;
            color: white;
            text-decoration: none;
            font-weight: bold;
            border-radius: 4px;
            margin: 20px 0;
            cursor: move;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .bookmarklet:hover {
            background: #45a049;
        }

        .note {
            background: #f6f8fa;
            border-left: 3px solid #0366d6;
            padding: 16px;
            margin: 16px 0;
        }

        .screenshot {
            max-width: 100%;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin: 20px 0;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .feature-list {
            padding-left: 20px;
        }

        .feature-list li {
            margin-bottom: 8px;
        }

        .instructions {
            margin-bottom: 30px;
        }

        hr {
            margin: 30px 0;
            border: 0;
            height: 1px;
            background: #eaecef;
        }

        .highlight-banner {
            background: #f0fff0;
            border: 1px solid #4caf50;
            border-radius: 5px;
            padding: 15px;
            margin: 20px 0;
            text-align: center;
        }

        .arrow-animation {
            animation: bounce 2s infinite;
            display: inline-block;
            font-size: 24px;
        }

        @keyframes bounce {

            0%,
            20%,
            50%,
            80%,
            100% {
                transform: translateY(0);
            }

            40% {
                transform: translateY(-10px);
            }

            60% {
                transform: translateY(-5px);
            }
        }

        .install-button {
            margin-top: 20px;
            text-align: center;
        }

        .code-box {
            background: #f6f8fa;
            padding: 15px;
            border-radius: 5px;
            border: 1px solid #ddd;
            font-family: monospace;
            font-size: 13px;
            overflow-x: auto;
            max-height: 200px;
            overflow-y: auto;
            margin: 20px 0;
            white-space: pre;
        }
    </style>
</head>

<body>
    <h1>ğŸ›’ Amazon Order Loader Bookmarklet</h1>

    <div class="highlight-banner">
        <h3 style="margin-top: 0;">ğŸ“± Works directly in your browser!</h3>
        <p><strong>Just drag and drop the button below to your bookmarks bar - no installation needed!</strong></p>
        <div class="arrow-animation">â¬‡ï¸</div>
    </div>

    <p>This bookmarklet automatically loads <strong>all your Amazon order history pages</strong> into a single view, no
        matter where you start: the default order page, a specific year, or a filtered view (like "last 30 days").</p>

    <div class="feature-list">
        <p>It:</p>
        <ul>
            <li>âœ… Works on any Amazon Orders URL (<code>/your-orders/orders?...</code>)</li>
            <li>ğŸ“„ Appends all order cards from all pages onto the same page</li>
            <li>ğŸ“Š Shows a <strong>smooth, semi-transparent progress modal</strong></li>
            <li>ğŸš€ Fades out cleanly when all pages are loaded</li>
            <li>ğŸ›‘ Detects when you're on the last page and exits with no unnecessary requests</li>
        </ul>
    </div>

    <hr>

    <h2>âœ¨ Features</h2>
    <ul class="feature-list">
        <li>ğŸ” Automatically discovers how many pages exist (even if hidden under <code>...</code> in pagination)</li>
        <li>ğŸ§  Starts only from the current page and fetches forward</li>
        <li>ğŸ’¡ Adaptive to any date filters or pagination</li>
        <li>ğŸ’¬ Clean console logs for debugging</li>
        <li>ğŸ¨ Beautiful modal UI in the center of the screen</li>
        <li>â³ Animated progress bar and dimmed background</li>
        <li>ğŸ§¼ Overlay fades away after loading completes</li>
    </ul>

    <hr>

    <h2>ğŸ“¥ Super Simple Installation</h2>

    <div class="instructions">
        <h3>1. Quick Drag & Drop Method</h3>
        <p><strong>Simply drag this button to your bookmarks bar:</strong></p>

        <div class="install-button">
            <a class="bookmarklet"
                href="javascript:(function(){var o=location.origin,e=new Set;function t(){let o=document.getElementById('amazon-order-loader-overlay');if(o)return o;o=document.createElement('div'),o.id='amazon-order-loader-overlay',o.style.cssText='position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.5);display:flex;align-items:center;justify-content:center;z-index:9999;transition:opacity 0.5s ease;';const t=document.createElement('div');t.style.cssText='background:#fff;padding:20px 30px;border-radius:10px;font-family:sans-serif;font-size:16px;box-shadow:0 0 20px rgba(0,0,0,0.3);text-align:center;min-width:200px;';t.innerHTML='&lt;div style=&quot;margin-bottom:10px;&quot;&gt;ğŸ“¦ &lt;strong id=&quot;amazon-progress-text&quot;&gt;Loading...&lt;/strong&gt;&lt;/div&gt;&lt;div style=&quot;background:#eee;border-radius:5px;overflow:hidden;&quot;&gt;&lt;div id=&quot;amazon-progress-bar&quot; style=&quot;height:10px;width:0;background:#4caf50;transition:width 0.3s ease;&quot;&gt;&lt;/div&gt;&lt;/div&gt;',o.appendChild(t),document.body.appendChild(o);return o}function n(o,t){const n=document.getElementById('amazon-progress-text'),e=document.getElementById('amazon-progress-bar');n&&(n.textContent='Loading page '+o+' of '+t),e&&(e.style.width=Math.min(100*o/t,100)+'%')}function r(){const o=document.getElementById('amazon-order-loader-overlay');o&&(o.style.opacity='0',setTimeout(function(){o.remove()},1e3))}function a(){const o=document.querySelector('ul.a-pagination li.a-selected');if(!o)return null;const t=parseInt(o.textContent.trim(),10);return isNaN(t)?null:t}function c(o){let t=0;return[...o.querySelectorAll('ul.a-pagination li')].forEach(function(o){const n=o.querySelector('a');if(n){const e=n.href.match(/startIndex=(\\d+)/);e&&parseInt(e[1])>t&&(t=parseInt(e[1]))}}),t}function i(o,t){for(const n of o.querySelectorAll('ul.a-pagination a'))if(n.href.includes('startIndex=')){const e=new URL(n.href,o.origin);return e.searchParams.set('startIndex',t.toString()),e.toString()}return null}async function d(t,n,r){const a=i(document,t);if(!a)return console.error('[ERROR] Could not build page URL.'),null;console.log('[INFO] Fetching page '+n+'/'+r+': '+a);try{const i=await fetch(a,{credentials:'include'});if(!i.ok)throw new Error('HTTP '+i.status);const d=await i.text(),l=new DOMParser,u=l.parseFromString(d,'text/html'),m=u.querySelectorAll('li.order-card__list');console.log('[INFO] Found '+m.length+' order card(s) on page '+n);const p=document.querySelector('li.order-card__list:last-of-type');if(!p)return console.error('[ERROR] Could not find last order card on current page.'),u;const s=p.parentNode,f=p.nextSibling;m.forEach(function(o){const t=o.cloneNode(!0);s.insertBefore(t,f)}),console.log('[SUCCESS] Appended '+m.length+' card(s) from page '+n),n(n,r);return u}catch(y){return console.error('[ERROR] Failed to fetch or process page '+n+':',y),null}}const l=a();if(!l)return void console.error('[ERROR] Could not determine the current page number.');const u=document,m=c(u),p=Math.floor(m/10)+1;let s=10*(l-1)+10,f=l;console.log('[INFO] Current page: '+l),s>m?console.log('[âœ… DONE] You\'re already on the last page ('+l+'). No additional pages to load.'):(console.log('[INFO] Starting from page: '+(f+1)),console.log('[INFO] Initial total page estimate: '+p),t(),n(f,p),async function(){while(s<=m){if(e.has(s)){console.warn('[WARN] Already fetched startIndex='+s+', skipping.'),s+=10;continue}f++,e.add(s);const o=await d(s,f,p);if(!o)break;const t=c(o);t>m&&(console.log('[INFO] Updated maxStartIndex to '+t+' (was '+m+')'),m=t,p=Math.floor(m/10)+1),s+=10}console.log('[âœ… DONE] All future order pages have been loaded.'),n(p,p),setTimeout(r,3e3)}()})();">ğŸ›’
                Load Amazon Orders</a>
        </div>

        <div class="note">
            <p><strong>How to use:</strong> Drag the green button above to your bookmarks bar. If your bookmarks bar
                isn't visible, press <code>Ctrl+Shift+B</code> (Windows/Chrome) or <code>Cmd+Shift+B</code> (Mac) to
                show it.</p>
        </div>

        <div class="highlight-banner">
            <p><strong>That's it! No installation required!</strong></p>
            <p>Just visit any Amazon orders page and click your new bookmark.</p>
        </div>
    </div>

    <div class="instructions">
        <h3>2. Manual Bookmark Creation (Alternative)</h3>
        <ol>
            <li>In your browser, open the bookmarks manager</li>
            <li>Add a <strong>new bookmark</strong></li>
            <li>Set the <strong>name</strong> to: <code>ğŸ›’ Load All Amazon Orders</code></li>
            <li>Set the <strong>URL</strong> to the bookmarklet code:</li>
        </ol>



        <div class="note">
            <p><strong>Note:</strong> Make sure the code starts with <code>javascript:(function(){...})()</code></p>
        </div>
    </div>

    <hr>

    <h2>â–¶ï¸ Usage</h2>
    <ol>
        <li>Go to your Amazon Orders page (any of these will work):
            <ul>
                <li><code>https://www.amazon.com/your-orders/orders</code></li>
                <li><code>https://www.amazon.com/your-orders/orders?timeFilter=year-2024</code></li>
                <li><code>https://www.amazon.com/your-orders/orders?startIndex=10</code></li>
                <li><code>https://www.amazon.com/your-orders/orders?timeFilter=last30</code></li>
            </ul>
        </li>
        <li><strong>Click your bookmarklet</strong> (the bookmark you created).</li>
        <li>Watch the progress bar and let it load all your orders from all pages.</li>
        <li>Once finished, the UI will disappear smoothly â€” and your page will show everything in one view.</li>
    </ol>

    <hr>

    <h2>ğŸ“· Screenshots</h2>
    <h3>ğŸ”˜ Before loading</h3>
    <img class="screenshot" src="./screenshots/before-loading.png" alt="Before loading">

    <h3>ğŸ“¦ While loading</h3>
    <img class="screenshot" src="./screenshots/while-loading.png" alt="While loading">

    <h3>âœ… After loading is complete</h3>
    <img class="screenshot" src="./screenshots/after-loading.png" alt="After loading">

    <hr>

    <h2>ğŸ›  Development</h2>
    <p>To tweak the behavior (e.g., add export to CSV, auto-scroll, or more styling):</p>
    <ul>
        <li>Work with <a
                href="https://github.com/sabbah13/amazon-orders-loader/blob/main/src/bookmarklet.source.js">src/bookmarklet.source.js</a>
        </li>
        <li>Then use a minifier like <a href="https://caiorss.github.io/bookmarklet-maker/">Bookmarklet Maker</a> or <a
                href="https://github.com/terser/terser">Terser</a></li>
        <li>Paste the final one-liner into your bookmark</li>
    </ul>

    <hr>

    <h2>ğŸ“„ License</h2>
    <p>MIT â€” free to use and modify for personal or commercial use.</p>

    <hr>

    <h2>ğŸ™‹â€â™€ï¸ Support</h2>
    <p>If you find a bug or want to suggest an enhancement, feel free to open an <a
            href="https://github.com/sabbah13/amazon-orders-loader/issues">issue</a> or PR.</p>

    <hr>

    <p>Enjoy your full-order history with one click! ğŸ‰</p>

    <footer
        style="margin-top: 50px; text-align: center; color: #586069; border-top: 1px solid #eaecef; padding-top: 20px;">
        <p>View this project on <a href="https://github.com/sabbah13/amazon-orders-loader">GitHub</a></p>
    </footer>
</body>

</html>